// Copyright (c) Microsoft Corporation.
// Licensed under the MIT license.

syntax = "proto3";
package compute;

import "google/protobuf/wrappers.proto";
import "common.proto";

enum UserType {
	ROOT = 0;
	USER = 1;
}

enum OperatingSystemType {
	WINDOWS = 0;
	LINUX = 1;
}

message VirtualMachineRequest {
	repeated VirtualMachine VirtualMachineSystems = 1;
	Operation OperationType = 2;
}

message VirtualMachineResponse {
	repeated VirtualMachine VirtualMachineSystems = 1;
	google.protobuf.BoolValue Result = 2;
	string  Error = 3;
}

message SSHPublicKey {
	string keydata = 1;
}

message Disk {
	// reference to the virtual hard disk managed by storage
	string diskid = 1;
}

message StorageConfiguration {
	Disk osdisk = 1;
	repeated Disk datadisks = 2;
}

message NetworkInterface {
	// reference to network interface managed by network
	string networkInterfaceId = 1;
}

message NetworkConfiguration {
	repeated NetworkInterface interfaces = 1;
}

message UserConfiguration {
	string username = 1;
	string password = 2;
	UserType usertype = 3;
}

message OperatingSystemConfiguration {
	string computerName = 1;
	UserConfiguration administrator = 2;
	repeated UserConfiguration users = 3;
	string customData = 4;
	repeated SSHPublicKey publickeys = 5;
	OperatingSystemType ostype = 6;
}

message VirtualMachine {
	string name = 1;
	string id = 2;
	StorageConfiguration storage = 3;
	OperatingSystemConfiguration os = 4;
	NetworkConfiguration network = 5;
}

service VirtualMachineAgent {
	rpc Invoke(VirtualMachineRequest) returns (VirtualMachineResponse) {}
}

